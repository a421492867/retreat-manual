### 分库分表


#### 为什么要分库分表
*当系统发展到一定的阶段 用户并发量大  会有大量的数据库请求 需要占用大量的数据库连接 同时会带来磁盘的IO瓶颈问题  此外 产生的数据也越来越多 一张表可能存不下  由于数据量太大 SQL语句查询数据即使走了索引也会非常耗时*


#### 路由算法
*1. id取模     2.给id指定一个区间范围    3.一致性Hash算法*


分库分表主要有两个方向 ： 垂直  水平



## 分库分表的4中分片策略

*标准分片策略、 复合分片策略、行表达式分片策略、Hint分片策略*
*分片策略分为分表策略和分库策略  实现分片算法的方式基本相同  不同的是一个对库  一个对表*

### 标准分片策略

> 使用场景 : SQL语句中有 >; >=; <=; <; = ; in 和 between and操作符  都可以应用此分片策略
>
> 只支持对单个分片键(字段)为依据的分库分表, 并提供了两种分片算法:PreciseShardingAlgorithm(标准分片) 和 RangeShardingAlgorithm(范围分片)

> 在使用标准分片策略时, 标准分片算法是必须实现的算法  用于SQL含有 = 和 in 的分片处理; 范围分片算法是非必选的, 用于处理含有BETWEEN AND的分片处理   **一旦我们没配置范围分片算法  而SQL用到了BETWEEN AND或者like 那么SQL将按全库.表路由的方式逐一执行 查询性能会很差**

#### 精准分片算法

> 实现PreciseShardingAlgorithm接口  并重写doSharding方法

#### 范围分片算法

> 实现RangeShardingAlgorithm接口  重写doSharding方法

### 复合分片策略

> 使用场景 : SQL语句中有 >; >=; <=; < ; =; in  和 between and等操作符  不同的是复合分片策略支持对多个分片键操作

> 实现ComplexKeyShardingAlgorithm接口 重写doSharding方法

### 行表达式分片策略

> 提供对SQL语句中的= 和 in的分片操作支持   只支持单分片键
>
> 适用于做简单的分片算法  无需自定义分片算法

### Hint分片策略

> 无需要配置分片键, 分片键值也不再从SQL中解析  而是由外部指定分片信息,让SQL在指定的分库,分表中执行

